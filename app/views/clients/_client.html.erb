<section class="panel-content">
  <div class="panel-info">

    <div class="basic-info">
      <img v-if="client.length != 0" class="ava" src="/resources/no-image-available.png">
      <div class="basic-info__container">
        <div class="basic-info__container__content">
          <div class="name-panel">{{client.last_name}} {{client.first_name}}</div>
          <div style="font-size: 13px; color: #444444;">{{ clientBasicInformation }}</div>
        </div>
      </div>

      <div v-on:click="showTotalInfo = !showTotalInfo" class="click-compact" v-bind:class="{ active: showTotalInfo }"><img src="images/_ionicons_svg_ios-arrow-down.svg"></div>
    </div>

    <div v-if="showTotalInfo" class="total-info">

      <div v-if="client.birthday != null" class="item-info">
        <div class="title-item-info">Дата рождения</div>
        <div class="content-item-info">{{client.birthday}}</div>
      </div>
      <div v-if="client.sex != null" class="item-info">
        <div class="title-item-info">Пол</div>
        <div class="content-item-info">{{client.sex}}</div>
      </div>

      <div id="fields-client">
        <div style="position: absolute; top: 0; width: 100%; height: 100%; background-color: white;">
          <img src="images/loading.gif" style="width: 60px; height: 60px; margin: auto; display: table; position: absolute; top: 0; right: 0; bottom: 0; left: 0;" />
        </div>
      </div>

    </div>

  </div>
  <div class="panel-panel">
    <div v-if="openPanelAdd == null">
      <div class="amount">
        <div class="amount-price">14000.0 ₽</div>
        <div class="amount-name">Оплатил</div>
      </div>

      <div class="amount" style="color: #ff7375;">
        <div class="amount-price">6000.0 ₽</div>
        <div class="amount-name">Долг</div>
      </div>

      <div class="btn-show-panel btn-show-list">
        <div class="panel-show" style="left: auto; right: 10px;">
          <a :href="urlEditClient">Редактировать</a>
        </div>
        <ion-icon style="width: 100%; height: 100%;" name="more"></ion-icon>
      </div>
      <div @click="openPanelAdd = 'addListForClient'" class="btn-add-panel">
          <ion-icon style="width: 100%; height: 100%;" name="add" role="img" class="hydrated" aria-label="add"></ion-icon>
      </div>
    </div>

    <section v-if="openPanelAdd == 'addListForClient'" class="panel-add">
      <h2 class="panel-form__title">
        <div @click="openPanelAdd = null" class="btn-back new-btn">
          <ion-icon name="arrow-back"></ion-icon>
        </div>
        <span>Добавление</span>
      </h2>

      <div>
        <div @click="openPanelAdd = 'addRecordClient'" class="item-panel" style="cursor: pointer;">
          <div class="item-panel__basic-info">
            <div class="left-item-panel">Записать в группу</div>
            <div class="right-item-panel"></div>
          </div>
        </div>
        <div @click="openPanelAdd = 'addSubscriptionClient'" class="item-panel" style="cursor: pointer;">
          <div class="item-panel__basic-info">
            <div class="left-item-panel">Продать абонемент</div>
            <div class="right-item-panel"></div>
          </div>
        </div>
      </div>
    </section>

    <section v-if="openPanelAdd == 'addRecordClient'" class="panel-add">
      <h2 class="panel-form__title">
        <div @click="openPanelAdd = 'addListForClient'" class="btn-back new-btn">
          <ion-icon name="arrow-back"></ion-icon>
        </div>
        <span>Запись клиента в группу</span>
      </h2>

      <div v-if="selectRecordsClient.length != 0" >
        <input type="hidden" id="authenticity_token" value="<%=form_authenticity_token%>">
        <div v-for="record in selectRecordsClient" class="item-panel">
          <div class="item-panel__basic-info">
            <div class="left-item-panel">{{ record.name }}</div>
            <div class="right-item-panel">
              <button @click="attachRecord(record)" :value="record.id" v-bind:class="{ active: subscribeLoading }" class="btn-subscribe btn">
                <div class="btn__text">Записать</div>
                <div v-if="subscribeLoading" class="container">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                     viewBox="0 0 240.7 8.9" style="enable-background:new 0 0 240.7 8.9;" xml:space="preserve">
                  <path d="M232.1,0c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.8-7.9-3.8l0,0c-0.1-0.2-3.6-3.9-8.6-4.1
                    c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C172,4,168.6,0.2,163.5,0
                    c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.7-7.9-3.8l0,0c-0.1-0.2-3.6-3.9-8.6-4.1
                    c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C103.4,4,100,0.2,95,0c-3.2-0.1-6.3,1.3-9.3,4.1
                    C83,6.8,80.1,8,77.2,7.9c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C69.2,4,65.7,0.2,60.7,0c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8
                    c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C34.9,4,31.5,0.2,26.4,0c-3.2-0.1-6.3,1.3-9.3,4.1C14.4,6.8,11.6,8,8.6,7.9C4,7.8,0.8,4.2,0.7,4.1
                    L0,4.8C0.1,5,3.5,8.8,8.6,8.9c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                    c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                    c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1C89.1,2.2,92,0.9,94.9,1c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                    c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                    c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                    c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.9,3.7,7.9,3.8l0,0
                    c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.9,3.8,7.9,3.8l0.7-0.7
                    C240.5,4,237.1,0.2,232.1,0z"/>
                  </svg>
                </div>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div v-else>
        <div class="no-record">Нет групп для записи</div>
      </div>
      <a href="/records/new" class="btn-add btn">+ Создать группу</a>
    </section>

    <section v-if="openPanelAdd == 'addSubscriptionClient'" class="panel-add">
      <h2 class="panel-form__title">
        <div @click="openPanelAdd = 'addListForClient'" class="btn-back new-btn">
          <ion-icon name="arrow-back"></ion-icon>
        </div>
        <span>Продажа абонемента</span>
      </h2>
      <div>
        <input type="hidden" id="authenticity_token" value="<%=form_authenticity_token%>">
        <div class="item-panel">
          <div class="item-panel__basic-info">
            <select v-model="addSubsForRecordClient">
              <option disabled value="">Выберите одну из записей</option>
              <option v-for="record in recordsClient" :value="record.id">{{ record.name }}</option>
            </select>

            <div v-if="addSubsForRecordClient != ''">

              <input v-model="startSubs" type="date" placeholder="Дата начала" />
              <input v-model="finishSubs" type="date" placeholder="Дата завершения" />
              
              <div style="font-size: 14px; color: #a4a4a4; margin-bottom: 10px; user-select: none;">{{ bookingDate }}</div>

              <input v-if='showAmount' v-model="amount" type="number" placeholder="Сумма оплаты" style="width: 100%;" />
              <input v-if='showRecalculationAmount' v-model="recalculationNote" type="text" placeholder="Причина прерасчета" style="width: 100%;"/>
              <input v-if="showRecalculationAmount && recalculationNote != ''" v-model="recalculationAmount" type="number" placeholder="Сумма прерасчета" style="width: 100%;" />

              <div class="btns" style="margin: 14px 0 0;">
                <button v-if="startSubs != '' && finishSubs != ''" @click="createSubClient()" v-bind:class="{ active: subsCreateLoading }" class="btn-subscribe btn" style="position: absolute; right: 10px; top: 0; padding: 15px; margin: 0;">
                  <div class="btn__text">Продать</div>
                  <div v-if="subsCreateLoading" class="container" style="width: 58px;">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                       viewBox="0 0 240.7 8.9" style="enable-background:new 0 0 240.7 8.9;" xml:space="preserve">
                    <path d="M232.1,0c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.8-7.9-3.8l0,0c-0.1-0.2-3.6-3.9-8.6-4.1
                      c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C172,4,168.6,0.2,163.5,0
                      c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.7-7.9-3.8l0,0c-0.1-0.2-3.6-3.9-8.6-4.1
                      c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C103.4,4,100,0.2,95,0c-3.2-0.1-6.3,1.3-9.3,4.1
                      C83,6.8,80.1,8,77.2,7.9c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C69.2,4,65.7,0.2,60.7,0c-3.2-0.1-6.3,1.3-9.3,4.1c-2.7,2.6-5.6,3.9-8.5,3.8
                      c-4.6-0.2-7.8-3.7-7.9-3.8l0,0C34.9,4,31.5,0.2,26.4,0c-3.2-0.1-6.3,1.3-9.3,4.1C14.4,6.8,11.6,8,8.6,7.9C4,7.8,0.8,4.2,0.7,4.1
                      L0,4.8C0.1,5,3.5,8.8,8.6,8.9c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                      c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                      c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1C89.1,2.2,92,0.9,94.9,1c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                      c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                      c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.8,3.7,7.9,3.8l0,0
                      c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.9,3.7,7.9,3.8l0,0
                      c0.1,0.2,3.5,3.9,8.6,4.1c0.1,0,0.3,0,0.4,0c3.1,0,6.1-1.4,8.9-4.1c2.7-2.6,5.6-3.9,8.5-3.8c4.6,0.2,7.9,3.8,7.9,3.8l0.7-0.7
                      C240.5,4,237.1,0.2,232.1,0z"/>
                    </svg>
                  </div>
                </button>
                <button @click="showAmount = !showAmount" class="btn gray">
                  <div v-if='!showAmount' class="btn__text">Оплатить</div>
                  <div v-else-if='showAmount' class="btn__text">Не оплачивать</div>
                </button>
                <button @click="showRecalculationAmount = !showRecalculationAmount" class="btn gray">
                  <div v-if='!showRecalculationAmount' class="btn__text">Прерасчет</div>
                  <div v-else-if='showRecalculationAmount' class="btn__text">Без перерасчета</div>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

  </div>
</section>

<%= render 'clients/records_client' %>

<%= render 'clients/transactions_client' %>

<div class="panel-content">
  <div class="panel-header">
    <div class="title-panel">Скидки и коррекция цены</div>
    <div class="show-panel">Показать все</div>
  </div>
  <div class="list-panel">
    <div class="item-panel">
      <div class="left-item-panel">Оплата за абонемент от 23 октября...</div>
      <div class="right-item-panel green">6000.0 ₽</div>
    </div>
  </div>
</div>